# Product Order Service - Flow Diagrams

## Complete Application Flow Visualization

### 1. System Architecture Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           COMPLETE SYSTEM FLOW                                │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │    │   Gateway   │    │   Service   │    │  Database   │
│  (Browser)  │───▶│   (Nginx)   │───▶│   Layer     │───▶│  (MySQL)    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Mobile    │    │   Load      │    │   Cache     │    │   Kafka     │
│   App       │    │  Balancer   │    │  (Redis)    │    │  Events     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Admin     │    │   SSL       │    │   Security  │    │  External   │
│   Panel     │    │  Term.      │    │   (JWT)     │    │  Services   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 2. User Authentication Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              AUTHENTICATION FLOW                              │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   User      │───▶│   Login     │───▶│   Security  │───▶│   JWT       │
│  Request    │    │   API       │    │   Filter    │    │  Generator  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Creds     │    │   Validate  │    │   Check     │    │   Token     │
│  Validation │    │   User      │    │   Roles     │    │  Creation   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Success   │    │   JWT       │    │   Session   │    │   Access    │
│  Response   │    │   Token     │    │  Storage    │    │  Granted    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 3. Product Search Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              PRODUCT SEARCH FLOW                               │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Search    │───▶│   Service   │───▶│   Cache     │───▶│   Cache     │
│  Request    │    │   Layer     │    │  (Redis)    │    │   Hit       │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Query     │    │   Cache     │    │   Database  │    │   Results   │
│  Builder    │    │   Miss      │    │  (MySQL)    │    │  Returned   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Filter    │    │   Cache     │    │   Query     │    │   JSON      │
│  Results    │    │   Update    │    │  Execution  │    │ Response    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 4. Order Creation Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              ORDER CREATION FLOW                               │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Order     │───▶│   Service   │───▶│   Product   │───▶│   Stock     │
│  Request    │    │   Layer     │    │ Validation  │    │  Check      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Validate  │    │   Create    │    │   Update    │    │   Reserve   │
│   Items     │    │   Order     │    │   Stock     │    │   Inventory │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Calculate │    │   Database  │    │   Cache     │    │   Kafka     │
│   Total     │    │   Insert    │    │ Invalidation│    │   Events    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Order     │    │   Order     │    │   Cache     │    │   Event     │
│  Created    │    │  Response   │    │   Updated   │    │ Published   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 5. Payment Processing Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            PAYMENT PROCESSING FLOW                             │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Payment   │───▶│   Service   │───▶│   gRPC      │───▶│  Payment    │
│  Request    │    │   Layer     │    │   Client    │    │  Service    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Validate  │    │   Prepare   │    │   Send      │    │   Process   │
│   Payment   │    │   gRPC      │    │   Request   │    │  Payment    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Check     │    │   Serialize │    │   Network   │    │   Authorize │
│   Amount    │    │   Data      │    │  Transport  │    │  Payment    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Process   │    │   Send      │    │   Receive   │    │   Return    │
│  Payment    │    │  Request    │    │  Response   │    │  Result     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Update    │    │   Kafka     │    │   Order     │    │   Payment   │
│   Order     │    │   Events    │    │  Status     │    │  Response   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 6. Event-Driven Architecture Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            EVENT-DRIVEN ARCHITECTURE                          │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Order    │───▶│   Kafka     │───▶│  Consumer   │───▶│ Notification│
│  Service    │    │  Producer   │    │  Services   │    │   Service   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Order     │    │   Event     │    │   Process   │    │   Send      │
│  Created    │    │ Published   │    │   Event     │    │   Email     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Payment   │    │   Event     │    │   Update    │    │   Send      │
│  Processed  │    │ Published   │    │  Inventory  │    │   SMS       │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Order     │    │   Event     │    │   Stock     │    │   Customer  │
│  Updated    │    │ Published   │    │  Updated    │    │ Notified    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 7. Complete Customer Journey Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              COMPLETE CUSTOMER JOURNEY                         │
└─────────────────────────────────────────────────────────────────────────────────┘

Step 1: Login
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Customer  │───▶│   Login     │───▶│   JWT       │───▶│   Access    │
│  Browser    │    │   API       │    │   Token     │    │  Granted    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

Step 2: Search Products
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Customer  │───▶│   Search    │───▶│   Cache     │───▶│   Product   │
│  Browser    │    │   API       │    │  (Redis)    │    │   Results   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

Step 3: Create Order
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Customer  │───▶│   Order     │───▶│   Payment   │───▶│   Order     │
│  Browser    │    │   API       │    │  Service    │    │  Created    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

Step 4: Process Payment
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Payment   │───▶│   gRPC      │───▶│   Payment   │───▶│   Payment   │
│  Service    │    │   Client    │    │  Gateway    │    │  Authorized │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

Step 5: Order Confirmation
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Order     │───▶│   Kafka     │───▶│ Notification│───▶│   Email     │
│  Service    │    │   Events    │    │   Service   │    │  Sent       │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 8. Error Handling Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              ERROR HANDLING FLOW                               │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │───▶│   Gateway   │───▶│   Service   │───▶│   Error     │
│  Request    │    │   (Nginx)   │    │   Layer     │    │  Handler    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Error     │    │   Error     │    │   Error     │    │   Error     │
│  Detection │    │  Logging    │    │  Response   │    │  Monitoring │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Error     │    │   Error     │    │   Error     │    │   Error     │
│  Response   │    │  Logging    │    │  Metrics    │    │  Alerts     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 9. Health Check Flow
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              HEALTH CHECK FLOW                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Load      │───▶│   Gateway   │───▶│   Service   │───▶│   Health    │
│  Balancer   │    │   (Nginx)   │    │   Layer     │    │  Checker    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Health    │    │   Database  │    │   Redis     │    │   Kafka     │
│  Request    │    │   Check     │    │   Check     │    │   Check     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Health    │    │   Health    │    │   Health    │    │   Health    │
│  Status     │    │  Metrics    │    │  Metrics    │    │  Metrics    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Health    │    │   Prometheus│    │   Grafana   │    │   Alerts    │
│  Response   │    │  Metrics    │    │  Dashboard  │    │  Generated  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### 10. Data Flow Summary
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              DATA FLOW SUMMARY                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │───▶│   Gateway   │───▶│   Service   │───▶│  Database   │
│  Request    │    │   (Nginx)   │    │   Layer     │    │  (MySQL)    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Response  │    │   Cache     │    │   Cache     │    │   Kafka     │
│   (JSON)    │    │  (Redis)    │    │  (Redis)    │    │  Events    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
        │                   │                   │                   │
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Client    │    │   Cache     │    │   Cache     │    │  External   │
│  Response   │    │  Hit/Miss   │    │  Update     │    │  Services   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

These flow diagrams provide a comprehensive visual representation of how the Product Order Service application works from start to end, covering all major components and their interactions.
